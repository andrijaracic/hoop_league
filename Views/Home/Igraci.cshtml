@model List<HoopLeague.Models.ViewModels.IgraciViewModel>

<h2>Igrači</h2>


<div class="players-page">

    <div class="players-search">
        <input type="text" id="searchInput" placeholder="Pretraga igrača..."
               onkeyup="searchPlayers()" />
    </div>

    <div id="players-container" class="players-grid">
        @foreach (var p in Model)
        {
            <a class="player-card"
               href="@Url.Action("Igrac", "Home", new { id = p.IgracId })">

                <img src="~/@p.TimLogo" alt="@p.Ime @p.Prezime" />

                <div class="player-info">
                    <b>@p.Ime @p.Prezime</b>
                    <span>@p.Tim - @p.Drzava</span>
                    <span>@p.Pozicija | #@p.BrojDresa</span>
                </div>

            </a>
        }
    </div>


    <div class="btn-load-more">
        <button onclick="loadMore()">Učitaj još</button>
    </div>

</div>



<script>
    let skip = 24;

    function loadMore() {
        fetch(`/Home/LoadMoreIgraci?skip=${skip}`)
            .then(r => r.json())
            .then(data => {
                appendPlayers(data);
                skip += 24;
            });
    }

    function searchPlayers() {
        let query = document.getElementById("searchInput").value;

        if (query.trim() === "") {
            location.reload();
            return;
        }

        fetch(`/Home/SearchIgraci?query=${query}`)
            .then(r => r.json())
            .then(data => renderPlayers(data));
    }

    function renderPlayers(players) {
        const container = document.getElementById("players-container");
        container.innerHTML = "";
        appendPlayers(players);
    }

        function appendPlayers(players) {
        const container = document.getElementById("players-container");

        players.forEach(p => {
            container.insertAdjacentHTML("beforeend", `
                <a class="player-card"
                   href="/Home/Igrac/${p.igracId}">

                    <img src="/${p.timLogo}" alt="${p.ime} ${p.prezime}" />

                    <div class="player-info">
                        <b>${p.ime} ${p.prezime}</b>
                        <span>${p.tim} - ${p.drzava}</span>
                        <span>${p.pozicija} | #${p.brojDresa}</span>
                    </div>

                </a>
            `);
        });
    }

</script>

